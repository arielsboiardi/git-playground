\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage[english]{babel}
\usepackage{csquotes}

%%% MATH
%%% ====
\usepackage{amsmath, amsfonts}

%%% GRAPHICS
%%% ========
\usepackage{graphicx}
\usepackage{subcaption}

%% TikZ
\usepackage{tikz}
\usetikzlibrary{external}

\tikzexternalize[
	mode = list and make,
	prefix=figures/,
]

\usepackage{pgfplots}
\pgfplotsset{compat = newest}
\pgfplotsset{every tick label/.append style = {font = \footnotesize}}
\pgfplotsset{every axis/.append style = thick}
\pgfplotsset{every axis/.append style = {line join = round, line cap = round}}
\pgfplotsset{cycle list name = exotic}
\pgfplotsset{enlarge x limits = false}

\usepackage{pgfplotstable}
\pgfplotstableset{
	col sep = comma,
	font = {\footnotesize},
	empty cells with = {--},
	every head row/.style = {before row=\toprule,after row=\midrule},
	every last row/.style = {after row = \bottomrule}
}

%%% Stuff
\usepackage{hyperref}
\usepackage{cleveref}

\input{commands.tex}

%% INFO
%% ====
\title{This is a test article with PGF pictures}
\author{Ariel S. Boiardi}

\begin{document}
    \maketitle

    \begin{abstract}
        This article is being typeset to test a Dockerized \LaTeX compiler.
        The figures in this paper are generated by data sheets and compiled into separate pdf files using Ti\textit{k}Z and its \texttt{external} library.
    \end{abstract}

\section{Parabola B-spline representation}
Let us consider the  the obstacle $\Gamma$ parametrized by the curve $\vect{C}(x) = \left( x, x^2 \right)$ for $x \in \left[-1, 1\right]$:
\begin{equation}\label{EXP:para:eq:boundary}
	\Gamma = \left\{ \vect{x} = \left(x, x ^2\right) \in \R^2 ,\ x \in [-1,1] \right\}.
\end{equation} 
The same curve can be parametrized by B-splines of degree $d=2$ 
\begin{equation*}
	\vect{C}(x) = \sum_{i=0}^{2} \vect{P}_i \bsp{i}{2}(x),
\end{equation*}
where the quadratic $\bsp{i}{2}$ are defined on the extended knot vector 
\begin{equation*}
	\Xi = 
	\begin{bmatrix}
		-1 &-1 &-1 & 1 & 1 & 1
	\end{bmatrix},
\end{equation*}
and the control points are 
\begin{equation*}
	\vect{P}_0 
	=
	\begin{bmatrix}
		-1 \\ 1
	\end{bmatrix},
	\quad
	\vect{P}_1 
	=
	\begin{bmatrix}
		0 \\ -1
	\end{bmatrix},
	\quad
	\vect{P}_0 
	=
	\begin{bmatrix}
		1 \\ 1
	\end{bmatrix};
\end{equation*}
the arc is shown in \cref{EXP:para:fig:parabolic_arc}.
\begin{figure}
	\centering
	\begin{tikzpicture}
		\begin{axis}
			\addplot[color=gray, dotted] coordinates {
				(-1, 1)
				(0, -1)
				(1, 1)
			};
			\addplot[color=gray, only marks] coordinates {
				(-1, 1)
				(0, -1)
				(1, 1)
			};
			\addplot[no marks] table[x=C1,y=C2] {data_sheets/curve_bspline.csv};
		\end{axis}
	\end{tikzpicture}
	\caption{Parabolic arc considered for experiments in \cref{EXP:para}. Control points and polygon plotted in grey.}
	\label{EXP:para:fig:parabolic_arc}
\end{figure}

\section{Some coloured plots}
\begin{figure}
	\centering
	\begin{tikzpicture}
		\begin{axis}[
			no marks,
			xlabel = $x$,
			ylabel = {$\psi(x,T)$},
			legend pos = north west
			]
			\addplot table[x=x,y=psi_deg0] {data_sheets/para/density_T100_Nt500_Nu10_alldegs.csv};
			\addlegendentry{$d=0$}
			\addplot table[x=x,y=psi_deg1] {data_sheets/para/density_T100_Nt500_Nu10_alldegs.csv};
			\addlegendentry{$d=1$}
			\addplot table[x=x,y=psi_deg2] {data_sheets/para/density_T100_Nt500_Nu10_alldegs.csv};
			\addlegendentry{$d=2$}
			\addplot table[x=x,y=psi_deg3] {data_sheets/para/density_T100_Nt500_Nu10_alldegs.csv};
			\addlegendentry{$d=3$}
			\addplot table[x=x,y=psi_deg4] {data_sheets/para/density_T100_Nt500_Nu10_alldegs.csv};
			\addlegendentry{$d=4$}
			\addplot table[x=x,y=psi_deg5] {data_sheets/para/density_T100_Nt500_Nu10_alldegs.csv};
			\addlegendentry{$d=5$}
			\addplot table[x=x,y=psi_deg6] {data_sheets/para/density_T100_Nt500_Nu10_alldegs.csv};
			\addlegendentry{$d=6$}
			\addplot[black, dotted] table[x=x,y=psi_infty] {data_sheets/para/density_T100_Nt500_Nu10_alldegs.csv};
			\addlegendentry{$\psi_\infty$}
		\end{axis}
	\end{tikzpicture}
	\label{EXP:para:fig:psi_T100_Nt500_Nu10_alldegs}
\end{figure}



\end{document}